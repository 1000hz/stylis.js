!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(global):"function"==typeof define&&define.amd?define(e(window)):window.stylis=e(window)}(function(e){"use strict";function r(e,t,i,s,n){e+="";var l="",a="",o=e.charCodeAt(0)||0;if(91===o){var f=e.substring(1,e.length-1).split("="),g=(a=f[1]).charCodeAt(0);34!==g&&39!==g||(a=a.substring(1,a.length-1)),l="["+f[0]+'="'+a+'"]'}else a=35===o||46===o||62===o?(l=e).substring(1):l=e;o=0;var d=void 0===i||i===!0?a:"",h=null!=n;if(h){var c=(typeof n).charCodeAt(0);if(111===c){var u=Object.keys(n).map(function(e){return[e,new RegExp(e+"\\([ \t\r\n]*([^\0]*?)[ \t\r\n]*\\)","g")]}),v=n,b=u.length;n=function(e,r,t,i){if(2===e){for(var s=0;s<b;s++){var n=u[s],l=n[0],a=n[1];r=r.replace(a,function(e,r){return v[l].apply(null,r.replace(/[ \t\r\n]*,[ \t\r\n]*/g,",").split(","))||e})}return r}}}else 102!==c&&(h=!1)}for(var p,m,x,A,C,y,w,k,O,j,E="",R="",N="",z="",F="",q=0,B=0,D=0,G=1,H=t.length,I=0,J=0,K=0,L=0,M=0,P=0,Q=0,S=0,T="-moz-",U="-ms-",V="-webkit-",W="";q<H;){var X=t.charCodeAt(q);if(0!==M||123!==X&&125!==X&&59!==X)13===X||10===X?(2===L&&(E="",L=0),D=0,G++):9!==X&&(34===X?M=34===M?0:39===M?39:34:39===X?M=39===M?0:34===M?34:39:47===X&&47===X&&L<2&&L++,E+=t[q]);else{E+=t[q];var Y=E.charCodeAt(0);32===Y&&(Y=(E=E.trim()).charCodeAt(0));var Z=E.charCodeAt(1)||0,$=E.charCodeAt(2)||0;if(h&&125!==X&&(C=123===X?n(0,E.substring(0,E.length-1).trim(),G,D):n(1,E,G,D),void 0!==C&&(E=123===X?C+"{":C)),2===L)125===X&&(L=0),E="";else if(64===Y){if(1===Q&&0!==F.length&&(Q=0,F=l+" {"+F+"}",h&&(C=n(3,F,G,D),void 0!==C&&(F=C)),W+=F,F=""),107===Z||103===Z)107===Z?(R=E.substring(1,11)+d+E.substring(11),E="@"+V+R,o=1):E="";else if(109===Z)if(s===!0&&105===$)void 0===O&&(O={}),R=(j=E.substring(7,E.indexOf("{"))+" ").trim(),j=j.substring(0,j.indexOf(" ")).trim(),O[j]={key:R.trim(),body:""},o=3,E="",R="";else if(101===$)if(0!==B){for(q++,A="",p="",m=y.split(","),K=1;q<H;){var g=t.charCodeAt(q);if(123===g?K++:125===g&&K--,0===K)break;p+=t[q++]}for(var _=0,ee=m.length;_<ee;_++)e=m[_],A+=r((_===ee-1?e.substring(0,e.length-1):e).trim(),p,i,s,n);A=E+A+"}",E="",o=4}else o=2;else o=6;if(105===Z){if(s===!0)if(110===$)if(E=E.substring(9,E.length-1),w=E.indexOf("("),w>-1){var re=E.substring(0,w),te=O[re],ie=E.substring(re.length+1,E.length-1).split(","),se=te.key.replace(re,"").replace(/\(|\)/g,"").trim().split(",");E=te.body;for(var _=0,ee=ie.length;_<ee;_++){var ne=se[_].trim();void 0!==ne&&(E=E.replace(new RegExp("var\\(~~"+ne+"\\)","g"),ie[_].trim()))}t+=E,H+=E.length,E=""}else E=O[E].body,0===B&&(t+=E,H+=E.length,E="");else if(109===$&&h){var le=/@import.*?(["'][^\.\n\r]*?["'];|["'].*\.scss["'])/g.exec(E);null!==le&&(E=n(4,le[1].replace(/['"; ]/g,""),G,D)||"",E&&(t=t.substring(0,q+1)+E+t.substring(q+1),H+=E.length),E="")}}else 4!==o&&(J=-1,I++)}else if(s===!0&&59===X&&126===Y&&126===Z){var ae=E.indexOf(":");void 0===k&&(k=[]),k[k.length]=[E.substring(0,ae),E.substring(ae+1,E.length-1).trim()],E=""}else{if(97===Y&&110===Z&&105===$){E=E.substring(0,E.length-1);var ae=E.indexOf(":")+1;x=E.substring(0,ae);var oe=E.substring(ae).trim().split(",");if(45!==(E.charCodeAt(9)||0))for(var fe=0,ee=oe.length;fe<ee;fe++){for(var ge=oe[fe],de=ge.split(" "),he=0,ce=de.length;he<ce;he++){var ue=de[he].trim(),ve=ue.charCodeAt(0),$=ue.charCodeAt(2),be=ue.length,pe=ue.charCodeAt(be-1);99===ve&&41===pe||105===ve&&102===$&&101===pe&&8===be||108===ve&&110===$&&114===pe&&6===be||97===ve&&116===$&&101===pe&&9===be||110===ve&&114===$&&108===pe&&6===be||98===ve&&99===$&&115===pe&&9===be||102===ve&&114===$&&115===pe&&8===be||98===ve&&116===$&&104===pe&&4===be||110===ve&&110===$&&101===pe&&4===be||101===ve&&115===$&&101===pe&&4===be||101===ve&&be>4&&45===ue.charCodeAt(4)||!isNaN(parseFloat(ue))||(de[he]=d+ue,ge=de.join(" "))}x+=(0===fe?"":",")+ge.trim()}else x+=(110!==(E.charCodeAt(10)||0)?"":d)+oe[0].trim();E=V+x+";"+x+";"}else if(97===Y&&112===Z&&112===$)E=V+E+T+E+E;else if(100===Y&&105===Z&&115===$)E.indexOf("flex")>-1&&(E="display:"+V+"box;display:"+V+"flex;"+U+"flexbox;display:flex;");else if(116===Y&&114===Z&&97===$)E=V+E+(102===E.charCodeAt(5)?U+E:"")+E;else if(104===Y&&121===Z&&112===$||117===Y&&115===Z&&101===$)E=V+E+T+E+U+E+E;else if(102===Y&&108===Z&&101===$)E=V+E+U+E+E;else if(111===Y&&114===Z&&100===$)E=V+E+U+"flex-"+E+E;else if(97===Y&&108===Z&&105===$&&45===(E.charCodeAt(5)||0))switch(E.charCodeAt(6)||0){case 105:C=E.replace("-items",""),E=V+"box-"+C+U+"flex-"+C+E;break;case 115:E=U+"flex-item-"+E.replace("-self","")+E;break;default:E=U+"flex-line-pack"+E.replace("align-content","")+E}else if(123===X){if(B++,1===Q&&0!==F.length&&(Q=0,F=l+" {"+F+"}",h&&(C=n(3,F,G,D),void 0!==C&&(F=C)),W+=F,F=""),0===I||2===o)if(2===B){q++,p="";var me=E.substring(0,E.length-1).split(","),xe=y.substring(0,y.length-1).split(",");for(K=1;q<H;){var g=t.charCodeAt(q);if(123===g?K++:125===g&&K--,0===K)break;p+=t[q++]}for(var fe=0,ee=xe.length;fe<ee;fe++){C=xe[fe],xe[fe]="";for(var he=0,ce=me.length;he<ce;he++)e=C.replace(l,"").trim(),e=me[he].indexOf(" &")>0?me[he].replace("&","").trim()+" "+e:e+" "+me[he].trim(),xe[fe]+=e.trim()+(he===ce-1?"":",")}E="\n"+xe.join(",")+" {"+p+"}",z+=E.replace(/&| +&/g,""),P=1,E="",B--}else{m=E.split(","),x="";for(var fe=0,ee=m.length;fe<ee;fe++){var Ae=(e=m[fe]).charCodeAt(0);if(32===Ae&&(Ae=(e=e.trim()).charCodeAt(0)),91===Ae)for(var he=fe+1,ce=ee-fe;he<ce;he++){var Ce=(e+=","+m[he]).trim();if(93===Ce.charCodeAt(Ce.length-1)){ee-=he,m.splice(fe,he);break}}if(38===Ae)e=l+e.substring(1);else if((w=e.indexOf(" &"))>0&&(Ae=58,e=":global("+e.substring(0,w)+")"+e.substring(w)),58===Ae){var ye=e.charCodeAt(1);if(104===ye&&116===e.charCodeAt(4)){var we=(e=e.substring(5)).charCodeAt(0);40===we?e=l+e.substring(1).replace(")",""):45===we?(w=e.indexOf(")"),e=e.substring(9,w)+" "+l+e.substring(w+1)):e=l+e}else e=103===ye?e.substring(8).replace(")","").replace("&",l):l+e}else e=l+" "+e;x+=0===fe?e:","+e}y=E=x}}else 125===X&&(0!==B&&B--,0===B&&1===P&&(t=t.substring(0,q+1)+z+t.substring(q+1),H+=z.length,z="",P=0,J++));0!==I?(125===X?J++:123===X&&0!==J&&J--,1!==S||123!==X&&0!==J||0===F.length||(S=0,E=l+" {"+F+"}"+E,F=""),0===J?(0===o?E="":1===o?(E="}@"+R+"}",R=""):3===o&&(O[j].body=R,j="",E="",R=""),o=0,J--,I--):1===o||3===o?(R+=E,3===o&&(E="")):2===o&&0===B&&(125!==X&&(0===S&&(F=""),F+=E,E=""),S=1)):0===B&&125!==X&&(Q=1,F=void 0===F?E:F+E,E="")}N+=E,E="",125!==X||0!==L||0!==o&&4!==o||(123!==N.charCodeAt(N.length-2)&&(h&&0!==N.length&&(C=n(2,N,G,D),void 0!==C&&(N=C)),W+=N.trim()),4===o&&(h&&(C=n(2,A,G,D),void 0!==C&&(A=C)),o=0,W+=A),N="")}q++,D++}if(void 0!==F&&0!==F.length&&(F=l+" {"+F+"}",h&&(C=n(3,F,G,D),void 0!==C&&(F=C)),W+=F),s&&void 0!==k)for(var _=0,ce=k.length;_<ce;_++)W=W.replace(new RegExp("var\\("+k[_][0]+"\\)","g"),k[_][1]);return h&&(C=n(5,W,G,D),void 0!==C&&(W=C)),W}return r});