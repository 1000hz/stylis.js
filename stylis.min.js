!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(global):"function"==typeof define&&define.amd?define(e(window)):window.stylis=e(window)}(function(e){"use strict";function t(e,t,i,r){var s="",n="",l=e.charCodeAt(0)||0;if(91===l){var o=e.substring(1,e.length-1).split("="),f=(n=o[1]).charCodeAt(0);34!==f&&39!==f||(n=n.substring(1,n.length-1)),s="["+o[0]+'="'+n+'"]'}else n=35===l||46===l||62===l?(s=e).substring(1):s=e;for(var a,g,d,h=void 0===i||i===!0?n:"",b=void 0!==r&&"function"==typeof r,c="",u="",v="",p="",m="",A=0,C=0,w=0,x=0,y=1,k=t.length,O=0,l=0,j=0,z=0,E=0,R="";C<k;){var q=t.charCodeAt(C);if(0!==E||123!==q&&125!==q&&59!==q)13===q||10===q?(2===z&&(c="",z=0),x=0,y++):9!==q&&(34===q?E=34===E?0:34:39===q?E=39===E?0:39:47===q&&47===q&&z<2&&z++,c+=t[C]);else{c+=t[C];var B=c.charCodeAt(0);32===B&&(B=(c=c.trim()).charCodeAt(0));var D=c.charCodeAt(1)||0,F=c.charCodeAt(2)||0;if(b&&(c=r(0,c,y,x)||c),2===z)125===q&&(z=0),c="";else if(64===B)if(107===D||103===D?107===D?(u=c.substring(1,11)+h+c.substring(11),c="@-webkit-"+u,l=1):c="":109===D&&(105===F?(void 0===g&&(g={}),u=(d=c.substring(7,c.indexOf("{"))+" ").trim(),d=d.substring(0,d.indexOf(" ")).trim(),g[d]={key:u.trim(),body:null},l=3,c="",u=""):l=2),105===D){if(110===F)if(c=c.substring(9,c.length-1),A=c.indexOf("("),A>-1){var G=c.substring(0,A),H=g[G],I=c.substring(G.length+1,c.length-1).split(","),J=H.key.replace(G,"").replace(/\(|\)/g,"").trim().split(",");c=H.body;for(var K=0,L=I.length;K<L;K++){var M=J[K].trim();void 0!==M&&(c=c.replace(new RegExp("\\"+M,"g"),I[K].trim()))}t+=c,k+=c.length,c=""}else c=g[c].body,0===w&&(t+=c,k+=c.length,c="");else if(109===F&&b){var N=/@import.*?(["'][^\.\n\r]*?["'];|["'].*\.scss["'])/g.exec(c);null!==N&&(c=r(3,N[1].replace(/['"; ]/g,""),y,x)||"",c&&(t+=c,k+=c.length),c="")}}else j=-1,O++;else if(36===B){var P=c.indexOf(":");void 0===a&&(a=[]),a[a.length]=[c.substring(0,P),c.substring(P+1,c.length-1).trim()],c=""}else{if(97===B&&110===D&&105===F){for(var Q=c.charCodeAt(9)||0,S=c.charCodeAt(10)||0,P=c.indexOf(":")+1,T=c.substring(0,P),U=c.substring(P).split(","),V=45!==Q?h:110!==S?"":h,W=0,L=U.length;W<L;W++)T+=(0===W?"":",")+V+U[W].trim();c="-webkit-"+T+T}else if(97===B&&112===D&&112===F)c="-webkit-"+c+"-moz-"+c+c;else if(104===B&&121===D&&112===F||117===B&&115===D&&101===F)c="-webkit-"+c+"-moz-"+c+"-ms-"+c+c;else if(102===B&&108===D&&101===F||111===B&&114===D&&100===F)c="-webkit-"+c+c;else if(116===B&&114===D&&97===F)c="-webkit-"+c+(102===c.charCodeAt(5)?"-ms-"+c:"")+c;else if(100===B&&105===D&&115===F)c.indexOf("flex")>-1&&(c="display:-webkit-flex; display:flex;");else if(123===q){if(w++,0===O||2===l)if(2===w){C++;for(var X="",Y=c.substring(0,c.length-1).split(","),Z=v.substring(0,v.length-1).split(","),$=1;C<k;){var f=t.charCodeAt(C);if(123===f?$++:125===f&&$--,0===$)break;X+=t[C++]}for(var W=0,L=Z.length;W<L;W++){var _=Z[W];Z[W]="";for(var ee=0,te=Y.length;ee<te;ee++)Z[W]+=(_.replace(s,"").trim()+" "+Y[ee].trim()).trim()+(ee===te-1?"":",")}k+=(t+=("\n"+Z.join(",")+"{"+X+"}").replace(/&| +&/g,"")).length,c="",w--}else{for(var ie=c.split(","),T="",W=0,L=ie.length;W<L;W++){var e=ie[W],re=e.charCodeAt(0);if(32===re&&(re=(e=e.trim()).charCodeAt(0)),91===re)for(var ee=W+1,te=L-W;ee<te;ee++){var se=(e+=","+ie[ee]).trim();if(93===se.charCodeAt(se.length-1)){L-=ee,ie.splice(W,ee);break}}if(38===re)e=s+e.substring(1);else if(58===re){var ne=e.charCodeAt(1);if(104===ne&&116===e.charCodeAt(4)){var le=(e=e.substring(5)).charCodeAt(0);e=40===le?s+e.substring(1).replace(")",""):45===le?e.substring(9,e.indexOf(")"))+" "+s+" {":s+e}else e=103===ne?e.substring(8).replace(")",""):s+e}else e=s+" "+e;T+=0===W?e:","+e}v=c=T}}else 125===q&&0!==w&&w--;0!==O?(125===q?j++:123===q&&0!==j&&j--,0===j?(0===l?c="":1===l?(c="}@"+u+"}",u=""):2===l?(0!==u.length&&(c=s+" {"+u+"}"+c),u=""):3===l&&(g[d].body=u,d="",c="",u=""),l=0,j--,O--):1===l||3===l?(u+=c,3===l&&(c="")):2===l&&0===w&&125!==q&&(u+=c,c="")):0===w&&125!==q&&(p+=c,c="")}m+=c,c="",125===q&&0===l&&0===z&&(b&&0!==m.length&&(m=r(1,m,y,x)||m),R+=m,m="")}C++,x++}if(0!==p.length&&(p=s+" {"+p+"}",b&&(p=r(2,p,y,x)||p),R+=p),void 0!==a)for(var K=0,te=a.length;K<te;K++)R=R.replace(new RegExp("\\"+a[K][0],"g"),a[K][1]);return R}return t});