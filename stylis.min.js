!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(global):"function"==typeof define&&define.amd?define(e(window)):window.stylis=e(window)}(function(e){"use strict";function r(e,i,t,s,l){e+="";var n="",a="",o=e.charCodeAt(0)||0;if(91===o){var f=e.substring(1,e.length-1).split("="),g=(a=f[1]).charCodeAt(0);34!==g&&39!==g||(a=a.substring(1,a.length-1)),n="["+f[0]+'="'+a+'"]'}else a=35===o||46===o||62===o?(n=e).substring(1):n=e;o=0;for(var d,h,c,b,v,u,p,m,x,A,C,y=void 0===t||t===!0?a:"",w=null!=l&&"function"==typeof l,k="",O="",j="",E=0,N=0,R=0,z=1,F=i.length,q=0,B=0,D=0,G=0,H=0,I="-moz-",J="-ms-",K="-webkit-",L="";E<F;){var M=i.charCodeAt(E);if(0!==H||123!==M&&125!==M&&59!==M)13===M||10===M?(2===G&&(k="",G=0),R=0,z++):9!==M&&(34===M?H=34===H?0:39===H?39:34:39===M?H=39===H?0:34===H?34:39:47===M&&47===M&&G<2&&G++,k+=i[E]);else{k+=i[E];var P=k.charCodeAt(0);32===P&&(P=(k=k.trim()).charCodeAt(0));var Q=k.charCodeAt(1)||0,S=k.charCodeAt(2)||0;if(w&&125!==M&&(u=123===M?l(0,k.substring(0,k.length-1).trim(),z,R):l(1,k,z,R),void 0!==u&&(k=123===M?u+"{":u)),2===G)125===M&&(G=0),k="";else if(64===P){if(107===Q||103===Q)107===Q?(O=k.substring(1,11)+y+k.substring(11),k="@"+K+O,o=1):k="";else if(109===Q)if(s===!0&&105===S)void 0===A&&(A={}),O=(C=k.substring(7,k.indexOf("{"))+" ").trim(),C=C.substring(0,C.indexOf(" ")).trim(),A[C]={key:O.trim(),body:""},o=3,k="",O="";else if(101===S)if(0!==N){for(E++,b="",d="",h=p.split(","),D=1;E<F;){var g=i.charCodeAt(E);if(123===g?D++:125===g&&D--,0===D)break;d+=i[E++]}for(var T=0,U=h.length;T<U;T++)e=h[T],b+=r((T===U-1?e.substring(0,e.length-1):e).trim(),d,t,s,l);b=k+b+"}",k="",o=4}else o=2;else o=6;if(105===Q){if(s===!0)if(110===S)if(k=k.substring(9,k.length-1),m=k.indexOf("("),m>-1){var V=k.substring(0,m),W=A[V],X=k.substring(V.length+1,k.length-1).split(","),Y=W.key.replace(V,"").replace(/\(|\)/g,"").trim().split(",");k=W.body;for(var T=0,U=X.length;T<U;T++){var Z=Y[T].trim();void 0!==Z&&(k=k.replace(new RegExp("var\\(~~"+Z+"\\)","g"),X[T].trim()))}i+=k,F+=k.length,k=""}else k=A[k].body,0===N&&(i+=k,F+=k.length,k="");else if(109===S&&w){var $=/@import.*?(["'][^\.\n\r]*?["'];|["'].*\.scss["'])/g.exec(k);null!==$&&(k=l(4,$[1].replace(/['"; ]/g,""),z,R)||"",k&&(i+=k,F+=k.length),k="")}}else 4!==o&&(B=-1,q++)}else if(s===!0&&59===M&&126===P&&126===Q){var _=k.indexOf(":");void 0===x&&(x=[]),x[x.length]=[k.substring(0,_),k.substring(_+1,k.length-1).trim()],k=""}else{if(97===P&&110===Q&&105===S){k=k.substring(0,k.length-1);var _=k.indexOf(":")+1;c=k.substring(0,_);var ee=k.substring(_).trim().split(",");if(45!==(k.charCodeAt(9)||0))for(var re=0,U=ee.length;re<U;re++){for(var ie=ee[re],te=ie.split(" "),se=0,le=te.length;se<le;se++){var ne=te[se].trim(),ae=ne.charCodeAt(0),S=ne.charCodeAt(2),oe=ne.length,fe=ne.charCodeAt(oe-1);99===ae&&41===fe||105===ae&&102===S&&101===fe&&8===oe||108===ae&&110===S&&114===fe&&6===oe||97===ae&&116===S&&101===fe&&9===oe||110===ae&&114===S&&108===fe&&6===oe||98===ae&&99===S&&115===fe&&9===oe||102===ae&&114===S&&115===fe&&8===oe||98===ae&&116===S&&104===fe&&4===oe||110===ae&&110===S&&101===fe&&4===oe||101===ae&&115===S&&101===fe&&4===oe||101===ae&&oe>4&&45===ne.charCodeAt(4)||!isNaN(parseFloat(ne))||(te[se]=y+ne,ie=te.join(" "))}c+=(0===re?"":",")+ie.trim()}else c+=(110!==(k.charCodeAt(10)||0)?"":y)+ee[0].trim();k=K+c+";"+c+";"}else if(97===P&&112===Q&&112===S)k=K+k+I+k+k;else if(100===P&&105===Q&&115===S)k.indexOf("flex")>-1&&(k="display:"+K+"box;display:"+K+"flex;"+J+"flexbox;display:flex;");else if(116===P&&114===Q&&97===S)k=K+k+(102===k.charCodeAt(5)?J+k:"")+k;else if(104===P&&121===Q&&112===S||117===P&&115===Q&&101===S)k=K+k+I+k+J+k+k;else if(102===P&&108===Q&&101===S)k=K+k+J+k+k;else if(111===P&&114===Q&&100===S)k=K+k+J+"flex-"+k+k;else if(97===P&&108===Q&&105===S&&45===(k.charCodeAt(5)||0))switch(k.charCodeAt(6)||0){case 105:u=k.replace("-items",""),k=K+"box-"+u+J+"flex-"+u+k;break;case 115:k=J+"flex-item-"+k.replace("-self","")+k;break;default:k=J+"flex-line-pack"+k.replace("align-content","")+k}else if(123===M){if(N++,0===q||2===o)if(2===N){E++,d="";var ge=k.substring(0,k.length-1).split(","),de=p.substring(0,p.length-1).split(",");for(D=1;E<F;){var g=i.charCodeAt(E);if(123===g?D++:125===g&&D--,0===D)break;d+=i[E++]}for(var re=0,U=de.length;re<U;re++){u=de[re],de[re]="";for(var se=0,le=ge.length;se<le;se++)e=u.replace(n,"").trim(),e=ge[se].indexOf(" &")>0?ge[se].replace("&","").trim()+" "+e:e+" "+ge[se].trim(),de[re]+=e.trim()+(se===le-1?"":",")}F+=(i+=("\n"+de.join(",")+" {"+d+"}").replace(/&| +&/g,"")).length,k="",N--}else{h=k.split(","),c="";for(var re=0,U=h.length;re<U;re++){var he=(e=h[re]).charCodeAt(0);if(32===he&&(he=(e=e.trim()).charCodeAt(0)),91===he)for(var se=re+1,le=U-re;se<le;se++){var ce=(e+=","+h[se]).trim();if(93===ce.charCodeAt(ce.length-1)){U-=se,h.splice(re,se);break}}if(38===he)e=n+e.substring(1);else if((m=e.indexOf(" &"))>0&&(he=58,e=":global("+e.substring(0,m)+")"+e.substring(m)),58===he){var be=e.charCodeAt(1);if(104===be&&116===e.charCodeAt(4)){var ve=(e=e.substring(5)).charCodeAt(0);40===ve?e=n+e.substring(1).replace(")",""):45===ve?(m=e.indexOf(")"),e=e.substring(9,m)+" "+n+e.substring(m+1)):e=n+e}else e=103===be?e.substring(8).replace(")","").replace("&",n):n+e}else e=n+" "+e;c+=0===re?e:","+e}p=k=c}}else 125===M&&0!==N&&N--;0!==q?(125===M?B++:123===M&&0!==B&&B--,0===B?(0===o?k="":1===o?(k="}@"+O+"}",O=""):2===o?(0!==O.length&&(k=n+" {"+O+"}"+k),O=""):3===o&&(A[C].body=O,C="",k="",O=""),o=0,B--,q--):1===o||3===o?(O+=k,3===o&&(k="")):2===o&&0===N&&125!==M&&(O+=k,k="")):0===N&&125!==M&&(v=void 0===v?k:v+k,k="")}j+=k,k="",125!==M||0!==G||0!==o&&4!==o||(123!==j.charCodeAt(j.length-2)&&(w&&0!==j.length&&(u=l(2,j,z,R),void 0!==u&&(j=u)),L+=j.trim()),4===o&&(w&&(u=l(2,b,z,R),void 0!==u&&(b=u)),o=0,L+=b),j="")}E++,R++}if(void 0!==v&&(v=n+" {"+v+"}",w&&(u=l(3,v,z,R),void 0!==u&&(v=u)),L+=v),void 0!==x)for(var T=0,le=x.length;T<le;T++)L=L.replace(new RegExp("var\\("+x[T][0]+"\\)","g"),x[T][1]);return L}return r});