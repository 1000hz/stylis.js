!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(global):"function"==typeof define&&define.amd?define(e(window)):window.stylis=e(window)}(function(e){"use strict";function t(e,t,r,i){var s="",n="",l=e.charCodeAt(0)||0;if(91===l){var a=e.substring(1,e.length-1).split("="),o=(n=a[1]).charCodeAt(0);34!==o&&39!==o||(n=n.substring(1,n.length-1)),s="["+a[0]+'="'+n+'"]'}else n=35===l||46===l||62===l?(s=e).substring(1):s=e;for(var f,g,d,h=void 0===r||r===!0?n:"",c=null!=i&&"function"==typeof i,b="",u="",v="",p="",m="",A=0,C=0,w=0,x=0,y=1,k=t.length,O=0,l=0,j=0,z=0,E=0,N="";C<k;){var R=t.charCodeAt(C);if(0!==E||123!==R&&125!==R&&59!==R)13===R||10===R?(2===z&&(b="",z=0),x=0,y++):9!==R&&(34===R?E=34===E?0:39===E?39:34:39===R?E=39===E?0:34===E?34:39:47===R&&47===R&&z<2&&z++,b+=t[C]);else{b+=t[C];var F=b.charCodeAt(0);32===F&&(F=(b=b.trim()).charCodeAt(0));var q=b.charCodeAt(1)||0,B=b.charCodeAt(2)||0;if(c&&(b=i(0,b,y,x)||b),2===z)125===R&&(z=0),b="";else if(64===F)if(107===q||103===q?107===q?(u=b.substring(1,11)+h+b.substring(11),b="@-webkit-"+u,l=1):b="":109===q&&(105===B?(void 0===g&&(g={}),u=(d=b.substring(7,b.indexOf("{"))+" ").trim(),d=d.substring(0,d.indexOf(" ")).trim(),g[d]={key:u.trim(),body:null},l=3,b="",u=""):l=2),105===q){if(110===B)if(b=b.substring(9,b.length-1),A=b.indexOf("("),A>-1){var D=b.substring(0,A),G=g[D],H=b.substring(D.length+1,b.length-1).split(","),I=G.key.replace(D,"").replace(/\(|\)/g,"").trim().split(",");b=G.body;for(var J=0,K=H.length;J<K;J++){var L=I[J].trim();void 0!==L&&(b=b.replace(new RegExp("var\\(~~"+L+"\\)","g"),H[J].trim()))}t+=b,k+=b.length,b=""}else b=g[b].body,0===w&&(t+=b,k+=b.length,b="");else if(109===B&&c){var M=/@import.*?(["'][^\.\n\r]*?["'];|["'].*\.scss["'])/g.exec(b);null!==M&&(b=i(3,M[1].replace(/['"; ]/g,""),y,x)||"",b&&(t+=b,k+=b.length),b="")}}else j=-1,O++;else if(59===R&&126===F&&126===q){var P=b.indexOf(":");void 0===f&&(f=[]),f[f.length]=[b.substring(0,P),b.substring(P+1,b.length-1).trim()],b=""}else{if(97===F&&110===q&&105===B){b=b.substring(0,b.length-1);var P=b.indexOf(":")+1,Q=b.substring(0,P),S=b.substring(P).trim().split(",");if(45!==(b.charCodeAt(9)||0))for(var T=0,K=S.length;T<K;T++){for(var U=S[T],V=U.split(" "),W=0,X=V.length;W<X;W++){var Y=V[W].trim(),Z=Y.charCodeAt(0),B=Y.charCodeAt(2),$=Y.length,_=Y.charCodeAt($-1);99===Z&&41===_||105===Z&&102===B&&101===_&&8===$||108===Z&&110===B&&114===_&&6===$||97===Z&&116===B&&101===_&&9===$||110===Z&&114===B&&108===_&&6===$||98===Z&&99===B&&115===_&&9===$||102===Z&&114===B&&115===_&&8===$||98===Z&&116===B&&104===_&&4===$||110===Z&&110===B&&101===_&&4===$||101===Z&&115===B&&101===_&&4===$||101===Z&&$>4&&45===Y.charCodeAt(4)||!isNaN(parseFloat(Y))||(V[W]=h+Y,U=V.join(" "))}Q+=(0===T?"":",")+U.trim()}else Q+=(110!==(b.charCodeAt(10)||0)?"":h)+S[0].trim();b="-webkit-"+Q+";"+Q+";"}else if(97===F&&112===q&&112===B)b="-webkit-"+b+"-moz-"+b+b;else if(104===F&&121===q&&112===B||117===F&&115===q&&101===B)b="-webkit-"+b+"-moz-"+b+"-ms-"+b+b;else if(102===F&&108===q&&101===B||111===F&&114===q&&100===B)b="-webkit-"+b+b;else if(116===F&&114===q&&97===B)b="-webkit-"+b+(102===b.charCodeAt(5)?"-ms-"+b:"")+b;else if(100===F&&105===q&&115===B)b.indexOf("flex")>-1&&(b="display:-webkit-flex; display:flex;");else if(123===R){if(w++,0===O||2===l)if(2===w){C++;for(var ee="",te=b.substring(0,b.length-1).split(","),re=v.substring(0,v.length-1).split(","),ie=1;C<k;){var o=t.charCodeAt(C);if(123===o?ie++:125===o&&ie--,0===ie)break;ee+=t[C++]}for(var T=0,K=re.length;T<K;T++){var se=re[T];re[T]="";for(var W=0,X=te.length;W<X;W++)re[T]+=(se.replace(s,"").trim()+" "+te[W].trim()).trim()+(W===X-1?"":",")}k+=(t+=("\n"+re.join(",")+" {"+ee+"}").replace(/&| +&/g,"")).length,b="",w--}else{for(var ne=b.split(","),Q="",T=0,K=ne.length;T<K;T++){var e=ne[T],le=e.charCodeAt(0);if(32===le&&(le=(e=e.trim()).charCodeAt(0)),91===le)for(var W=T+1,X=K-T;W<X;W++){var ae=(e+=","+ne[W]).trim();if(93===ae.charCodeAt(ae.length-1)){K-=W,ne.splice(T,W);break}}if(38===le)e=s+e.substring(1);else if(58===le){var oe=e.charCodeAt(1);if(104===oe&&116===e.charCodeAt(4)){var fe=(e=e.substring(5)).charCodeAt(0);e=40===fe?s+e.substring(1).replace(")",""):45===fe?e.substring(9,e.indexOf(")"))+" "+s+" {":s+e}else e=103===oe?e.substring(8).replace(")",""):s+e}else e=s+" "+e;Q+=0===T?e:","+e}v=b=Q}}else 125===R&&0!==w&&w--;0!==O?(125===R?j++:123===R&&0!==j&&j--,0===j?(0===l?b="":1===l?(b="}@"+u+"}",u=""):2===l?(0!==u.length&&(b=s+" {"+u+"}"+b),u=""):3===l&&(g[d].body=u,d="",b="",u=""),l=0,j--,O--):1===l||3===l?(u+=b,3===l&&(b="")):2===l&&0===w&&125!==R&&(u+=b,b="")):0===w&&125!==R&&(p+=b,b="")}m+=b,b="",125===R&&0===l&&0===z&&(123===m.charCodeAt(m.length-2)?m="":c&&0!==m.length&&(m=i(1,m,y,x)||m),N+=m,m="")}C++,x++}if(0!==p.length&&(p=s+" {"+p+"}",c&&(p=i(2,p,y,x)||p),N+=p),void 0!==f)for(var J=0,X=f.length;J<X;J++)N=N.replace(new RegExp("var\\("+f[J][0]+"\\)","g"),f[J][1]);return N}return t});