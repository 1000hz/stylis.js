!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(global):"function"==typeof define&&define.amd?define(e(window)):window.stylis=e(window)}(function(e){"use strict";function r(e,t,i,s,n){e+="";var l="",a="",o=e.charCodeAt(0)||0;if(91===o){var f=e.substring(1,e.length-1).split("="),g=(a=f[1]).charCodeAt(0);34!==g&&39!==g||(a=a.substring(1,a.length-1)),l="["+f[0]+'="'+a+'"]'}else a=35===o||46===o||62===o?(l=e).substring(1):l=e;o=0;var d=void 0===i||i===!0?a:"",h=null!=n;if(h){var c=(typeof n).charCodeAt(0);if(111===c){var u=Object.keys(n).map(function(e){return[e,new RegExp(e+"\\([ \t\r\n]*([^\0]*?)[ \t\r\n]*\\)","g")]}),v=n,b=u.length;n=function(e,r,t,i){if(2===e){for(var s=0;s<b;s++){var n=u[s],l=n[0],a=n[1];r=r.replace(a,function(e,r){return v[l].apply(null,r.replace(/[ \t\r\n]*,[ \t\r\n]*/g,",").split(","))||e})}return r}}}else 102!==c&&(h=!1)}for(var p,m,x,A,C,y,w,k,O,j,E,R="",N="",z="",F="",q=0,B=0,D=0,G=1,H=t.length,I=0,J=0,K=0,L=0,M=0,P=0,Q=0,S=0,T="-moz-",U="-ms-",V="-webkit-",W="";q<H;){var X=t.charCodeAt(q);if(0!==M||123!==X&&125!==X&&59!==X)13===X||10===X?(2===L&&(R="",L=0),D=0,G++):9!==X&&(34===X?M=34===M?0:39===M?39:34:39===X?M=39===M?0:34===M?34:39:47===X&&47===X&&L<2&&L++,R+=t[q]);else{R+=t[q];var Y=R.charCodeAt(0);32===Y&&(Y=(R=R.trim()).charCodeAt(0));var Z=R.charCodeAt(1)||0,$=R.charCodeAt(2)||0;if(h&&125!==X&&(y=123===X?n(0,R.substring(0,R.length-1).trim(),G,D):n(1,R,G,D),void 0!==y&&(R=123===X?y+"{":y)),2===L)125===X&&(L=0),R="";else if(64===Y){if(1===Q&&0!==C.length&&(Q=0,C=l+" {"+C+"}",h&&(y=n(3,C,G,D),void 0!==y&&(C=y)),W+=C,C=""),107===Z||103===Z)107===Z?(N=R.substring(1,11)+d+R.substring(11),R="@"+V+N,o=1):R="";else if(109===Z)if(s===!0&&105===$)void 0===j&&(j={}),N=(E=R.substring(7,R.indexOf("{"))+" ").trim(),E=E.substring(0,E.indexOf(" ")).trim(),j[E]={key:N.trim(),body:""},o=3,R="",N="";else if(101===$)if(0!==B){for(q++,A="",p="",m=w.split(","),K=1;q<H;){var g=t.charCodeAt(q);if(123===g?K++:125===g&&K--,0===K)break;p+=t[q++]}for(var _=0,ee=m.length;_<ee;_++)e=m[_],A+=r((_===ee-1?e.substring(0,e.length-1):e).trim(),p,i,s,n);A=R+A+"}",R="",o=4}else o=2;else o=6;if(105===Z){if(s===!0)if(110===$)if(R=R.substring(9,R.length-1),k=R.indexOf("("),k>-1){var re=R.substring(0,k),te=j[re],ie=R.substring(re.length+1,R.length-1).split(","),se=te.key.replace(re,"").replace(/\(|\)/g,"").trim().split(",");R=te.body;for(var _=0,ee=ie.length;_<ee;_++){var ne=se[_].trim();void 0!==ne&&(R=R.replace(new RegExp("var\\(~~"+ne+"\\)","g"),ie[_].trim()))}t+=R,H+=R.length,R=""}else R=j[R].body,0===B&&(t+=R,H+=R.length,R="");else if(109===$&&h){var le=/@import.*?(["'][^\.\n\r]*?["'];|["'].*\.scss["'])/g.exec(R);null!==le&&(R=n(4,le[1].replace(/['"; ]/g,""),G,D)||"",R&&(t=t.substring(0,q+1)+R+t.substring(q+1),H+=R.length),R="")}}else 4!==o&&(J=-1,I++)}else if(s===!0&&59===X&&126===Y&&126===Z){var ae=R.indexOf(":");void 0===O&&(O=[]),O[O.length]=[R.substring(0,ae),R.substring(ae+1,R.length-1).trim()],R=""}else{if(97===Y&&110===Z&&105===$){R=R.substring(0,R.length-1);var ae=R.indexOf(":")+1;x=R.substring(0,ae);var oe=R.substring(ae).trim().split(",");if(45!==(R.charCodeAt(9)||0))for(var fe=0,ee=oe.length;fe<ee;fe++){for(var ge=oe[fe],de=ge.split(" "),he=0,ce=de.length;he<ce;he++){var ue=de[he].trim(),ve=ue.charCodeAt(0),$=ue.charCodeAt(2),be=ue.length,pe=ue.charCodeAt(be-1);99===ve&&41===pe||105===ve&&102===$&&101===pe&&8===be||108===ve&&110===$&&114===pe&&6===be||97===ve&&116===$&&101===pe&&9===be||110===ve&&114===$&&108===pe&&6===be||98===ve&&99===$&&115===pe&&9===be||102===ve&&114===$&&115===pe&&8===be||98===ve&&116===$&&104===pe&&4===be||110===ve&&110===$&&101===pe&&4===be||101===ve&&115===$&&101===pe&&4===be||101===ve&&be>4&&45===ue.charCodeAt(4)||!isNaN(parseFloat(ue))||(de[he]=d+ue,ge=de.join(" "))}x+=(0===fe?"":",")+ge.trim()}else x+=(110!==(R.charCodeAt(10)||0)?"":d)+oe[0].trim();R=V+x+";"+x+";"}else if(97===Y&&112===Z&&112===$)R=V+R+T+R+R;else if(100===Y&&105===Z&&115===$)R.indexOf("flex")>-1&&(R="display:"+V+"box;display:"+V+"flex;"+U+"flexbox;display:flex;");else if(116===Y&&114===Z&&97===$)R=V+R+(102===R.charCodeAt(5)?U+R:"")+R;else if(104===Y&&121===Z&&112===$||117===Y&&115===Z&&101===$)R=V+R+T+R+U+R+R;else if(102===Y&&108===Z&&101===$)R=V+R+U+R+R;else if(111===Y&&114===Z&&100===$)R=V+R+U+"flex-"+R+R;else if(97===Y&&108===Z&&105===$&&45===(R.charCodeAt(5)||0))switch(R.charCodeAt(6)||0){case 105:y=R.replace("-items",""),R=V+"box-"+y+U+"flex-"+y+R;break;case 115:R=U+"flex-item-"+R.replace("-self","")+R;break;default:R=U+"flex-line-pack"+R.replace("align-content","")+R}else if(123===X){if(B++,1===Q&&0!==C.length&&(Q=0,C=l+" {"+C+"}",h&&(y=n(3,C,G,D),void 0!==y&&(C=y)),W+=C,C=""),0===I||2===o)if(2===B){q++,p="";var me=R.substring(0,R.length-1).split(","),xe=w.substring(0,w.length-1).split(",");for(K=1;q<H;){var g=t.charCodeAt(q);if(123===g?K++:125===g&&K--,0===K)break;p+=t[q++]}for(var fe=0,ee=xe.length;fe<ee;fe++){y=xe[fe],xe[fe]="";for(var he=0,ce=me.length;he<ce;he++)e=y.replace(l,"").trim(),e=me[he].indexOf(" &")>0?me[he].replace("&","").trim()+" "+e:e+" "+me[he].trim(),xe[fe]+=e.trim()+(he===ce-1?"":",")}R="\n"+xe.join(",")+" {"+p+"}",F+=R.replace(/&| +&/g,""),P=1,R="",B--}else{m=R.split(","),x="";for(var fe=0,ee=m.length;fe<ee;fe++){var Ae=(e=m[fe]).charCodeAt(0);if(32===Ae&&(Ae=(e=e.trim()).charCodeAt(0)),91===Ae)for(var he=fe+1,ce=ee-fe;he<ce;he++){var Ce=(e+=","+m[he]).trim();if(93===Ce.charCodeAt(Ce.length-1)){ee-=he,m.splice(fe,he);break}}if(38===Ae)e=l+e.substring(1);else if((k=e.indexOf(" &"))>0&&(Ae=58,e=":global("+e.substring(0,k)+")"+e.substring(k)),58===Ae){var ye=e.charCodeAt(1);if(104===ye&&116===e.charCodeAt(4)){var we=(e=e.substring(5)).charCodeAt(0);40===we?e=l+e.substring(1).replace(")",""):45===we?(k=e.indexOf(")"),e=e.substring(9,k)+" "+l+e.substring(k+1)):e=l+e}else e=103===ye?e.substring(8).replace(")","").replace("&",l):l+e}else e=l+" "+e;x+=0===fe?e:","+e}w=R=x}}else 125===X&&(0!==B&&B--,0===B&&1===P&&(t=t.substring(0,q+1)+F+t.substring(q+1),H+=F.length,F="",P=0,J++));0!==I?(125===X?J++:123===X&&0!==J&&J--,1!==S||123!==X&&0!==J||0===C.length||(S=0,R=l+" {"+C+"}"+R,C=""),0===J?(0===o?R="":1===o?(R="}@"+N+"}",N=""):3===o&&(j[E].body=N,E="",R="",N=""),o=0,J--,I--):1===o||3===o?(N+=R,3===o&&(R="")):2===o&&0===B&&(125!==X&&(0===S&&(C=""),C+=R,R=""),S=1)):0===B&&125!==X&&(Q=1,C=void 0===C?R:C+R,R="")}z+=R,R="",125!==X||0!==L||0!==o&&4!==o||(123!==z.charCodeAt(z.length-2)&&(h&&0!==z.length&&(y=n(2,z,G,D),void 0!==y&&(z=y)),W+=z.trim()),4===o&&(h&&(y=n(2,A,G,D),void 0!==y&&(A=y)),o=0,W+=A),z="")}q++,D++}if(void 0!==C&&0!==C.length&&(C=l+" {"+C+"}",h&&(y=n(3,C,G,D),void 0!==y&&(C=y)),W+=C),s&&void 0!==O)for(var _=0,ce=O.length;_<ce;_++)W=W.replace(new RegExp("var\\("+O[_][0]+"\\)","g"),O[_][1]);return h&&(y=n(5,W,G,D),void 0!==y&&(W=y)),W}return r});